---
import RenderBlock from "@components/utils/renderBlock.astro";
import { hasMeaningfulSlotContent } from "@components/utils/slotContent";

const {
  contentSections,
  editable = true,
  index,
  uniqueId,
  _component,
  ...htmlAttributes
} = Astro.props;

const hasDefaultSlot = await hasMeaningfulSlotContent(Astro.slots);
const usesContentSections = !hasDefaultSlot;
---

<div
  class="panel"
  id={`panel-${uniqueId}-${index}`}
  role="tabpanel"
  aria-labelledby={`tablabel-${uniqueId}-${index}`}
  aria-hidden={index !== 0}
  data-editable={editable && usesContentSections ? "array" : undefined}
  data-prop="contentSections"
  {...htmlAttributes}
>
  <slot>
    {contentSections && <RenderBlock contentSections={contentSections} editable={editable} />}
  </slot>
</div>

<style lang="pcss" is:global>
  @layer components {
    .panel {
      container-type: inline-size;
      animation: fade-in var(--animation-slow) ease-in-out forwards;
      display: none;
      padding: 0 var(--spacing-md);

      > [data-editable="array-item"]:first-child > *:first-child,
      > :not([data-editable="array-item"]):first-child {
        margin-top: 0 !important;
      }
    }
  }
</style>
